<?xml version="1.0" encoding="UTF-8"?>
<!--                                                                  -->
<!-- Copyright (c) Microsoft Corporation. All rights reserved.        -->
<!-- This code is licensed under the Visual Studio SDK license terms. -->
<!-- THIS CODE IS PROVIDED *AS IS* WITHOUT WARRANTY OF                -->
<!-- ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY               -->
<!-- IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR                   -->
<!-- PURPOSE, MERCHANTABILITY, OR NON-INFRINGEMENT.                   -->
<!--                                                                  -->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <?include Defines.wxi ?>
    <Fragment>
    <DirectoryRef Id="INSTALLDIR">
      <Component Id="ApplicationRegistry" Guid="*">

        <!-- These values come from the .reg file generated by the SDK's Isolated Shell template. -->
        <!-- We've replaced the folder tokens (e.g. $RootFolder$) with their actual values for the sample application. -->
        
        <RegistryKey Id='$(var.ShortProductName)RegKey' Root='HKLM' Key='$(var.ProductRegKey)' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='InstallDir' Value='[INSTALLDIR]'/>
          <RegistryValue Type='integer' Name='Installed' Value="1" KeyPath="yes" />
        </RegistryKey>
        
        <RegistryKey Id='DteClsidRegKey' Root='HKCR' Key='$(var.DteClsidRegKey)' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='$(var.ShortProductName) DTE Object' />
        </RegistryKey>
        
        <RegistryKey Id='DteLocSrv32RegKey' Root='HKCR' Key='$(var.DteClsidRegKey)\LocalServer32' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='[INSTALLDIR]$(var.ShortProductName).exe' />
        </RegistryKey>

        <RegistryKey Id='DteProgIDRegKey' Root='HKCR' Key='$(var.DteClsidRegKey)\ProgID' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='$(var.ShortProductName).DTE.$(var.ProductVersion)' />
        </RegistryKey>

        <RegistryKey Id='DteVersionIndependentProgIDRegKey' Root='HKCR' Key='$(var.DteClsidRegKey)\VersionIndependentProgID' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='$(var.ShortProductName).DTE' />
        </RegistryKey>

        <RegistryKey Id='DteProgrammableRegKey' Root='HKCR' Key='$(var.DteClsidRegKey)\Programmable' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='' />
        </RegistryKey>

        <RegistryKey Id='DteTypeLibRegKey' Root='HKCR' Key='$(var.DteClsidRegKey)\TypeLib' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='{80cc9f66-e7d8-4ddd-85b6-d9e6cd0e93e2}' />
        </RegistryKey>

        <RegistryKey Id='DteDefaultIconRegKey' Root='HKCR' Key='$(var.DteClsidRegKey)\DefaultIcon' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='[INSTALLDIR]$(var.ShortProductName).exe,1200' />
        </RegistryKey>

        <RegistryKey Id='DteVersionRegKey' Root='HKCR' Key='$(var.DteClsidRegKey)\Version' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='$(var.ProductVersion)' />
        </RegistryKey>

        <RegistryKey Id='SolClsidRegKey' Root='HKCR' Key='$(var.SolutionClsidRegKey)' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='$(var.ShortProductName) Solution Object' />
        </RegistryKey>

        <RegistryKey Id='SolLocSrv32RegKey' Root='HKCR' Key='$(var.SolutionClsidRegKey)\LocalServer32' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='[INSTALLDIR]$(var.ShortProductName).exe' />
        </RegistryKey>

        <RegistryKey Id='SolProgIDRegKey' Root='HKCR' Key='$(var.SolutionClsidRegKey)\ProgID' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='$(var.ShortProductName).Solution.$(var.ProductVersion)' />
        </RegistryKey>

        <RegistryKey Id='SolVersionIndependentProgIDRegKey' Root='HKCR' Key='$(var.SolutionClsidRegKey)\VersionIndependentProgID' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='$(var.ShortProductName).Solution' />
        </RegistryKey>

        <RegistryKey Id='SolProgrammableRegKey' Root='HKCR' Key='$(var.SolutionClsidRegKey)\Programmable' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='' />
        </RegistryKey>

        <RegistryKey Id='SolTypeLibRegKey' Root='HKCR' Key='$(var.SolutionClsidRegKey)\TypeLib' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='{80cc9f66-e7d8-4ddd-85b6-d9e6cd0e93e2}' />
        </RegistryKey>

        <RegistryKey Id='SolDefaultIconRegKey' Root='HKCR' Key='$(var.SolutionClsidRegKey)\DefaultIcon' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='[INSTALLDIR]$(var.ShortProductName).exe,1200' />
        </RegistryKey>

        <RegistryKey Id='SolVersionRegKey' Root='HKCR' Key='$(var.SolutionClsidRegKey)\Version' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='$(var.ProductVersion)' />
        </RegistryKey>

        <RegistryKey Id='DteRegKey' Root='HKCR' Key='$(var.ShortProductName).DTE.$(var.ProductVersion)' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='$(var.ShortProductName) DTE Object' />
        </RegistryKey>

        <RegistryKey Id='DteClsidRootRegKey' Root='HKCR' Key='$(var.ShortProductName).DTE.$(var.ProductVersion)\CLSID' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='{bb431796-a179-4df7-b65d-c0df6bda7cc6}' />
        </RegistryKey>

        <RegistryKey Id='SolRegKey' Root='HKCR' Key='$(var.ShortProductName).Solution.$(var.ProductVersion)' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='$(var.ShortProductName) Solution Object' />
        </RegistryKey>

        <RegistryKey Id='SolClsidRootRegKey' Root='HKCR' Key='$(var.ShortProductName).Solution.$(var.ProductVersion)\CLSID' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='{cc1af4e1-8b54-4f2b-981e-0155097d6309}' />
        </RegistryKey>

        <!-- These keys are necessary for out of process handling of VSIX files -->
        
        <RegistryKey Id='AppEnvRegKey' Root='HKLM' Key='SOFTWARE\Microsoft\AppEnv\$(var.ShellVersion)\Apps\$(var.ShortProductName)_$(var.ProductVersion)' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='StubExePath' Value='[INSTALLDIR]$(var.ShortProductName).exe' />
          <RegistryValue Type='string' Name='AppName' Value='$(var.ShortProductName)' />
        </RegistryKey>

        <RegistryKey Id='AppPathsRegKey' Root='HKLM' Key='SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\$(var.ShortProductName).exe' ForceCreateOnInstall='yes' ForceDeleteOnUninstall='yes'>
          <RegistryValue Type='string' Name='@' Value='[INSTALLDIR]$(var.ShortProductName).exe' />
        </RegistryKey>
        
      </Component>
    </DirectoryRef>
    </Fragment>
</Wix>